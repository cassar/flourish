<% content_for :title, 'Home'  %>
<article>
  <% if @last_distribution.present? && @unsettled %>
    <p><b>Current Distribution:</b></p>
    <ul>
      <li><b>Date</b>: <%= created_at_formatted @last_distribution %></li>
      <li><b>Members</b>: <%= @last_distribution.dividends.length %></li>
      <li><b>Dividend</b>: <%= @last_distribution.dividend_amount_formatted %></li>
      <li><b>Status</b>: <%= distribution_status dividend_statuses: @last_distribution.dividends.pluck(:status) %></li>
      <%= render 'distributions/aggregate_status_counts', disaggregate_status_counts: @last_distribution.dividends.group(:status).count %>
    </ul>
  <% else%>
    <p><b>Next Distribution:</b></p>
    <ul>
      <li><b>Date:</b> <%= next_distribution_date_formatted %></li>
      <li><b>Contributions:</b> <%= @total_pool %></li>
      <li><b>Members:</b> <%= @member_count %></li>
      <li><b>Dividend:</b> <%= @next_dividend_amount_formatted %></li>
    </ul>
  <% end %>
</article>
<%= render partial: 'details' %>
<nav>
  <%= link_to distributions_path, class: 'button' do %>
    Distributions
  <% end %>
  <%= render partial: 'authentication' %>
</nav>
